<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Collections â€“ Israeli Steam Games</title>
  <meta name="description" content="Curated collections of Israeli indie games on Steam.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŽ®</text></svg>">
  <style>
    :root {
      --bg: #0e1117;
      --surface: #161b22;
      --border: #30363d;
      --text: #e6edf3;
      --text-muted: #8b949e;
      --accent: #58a6ff;
      --pill-bg: #21262d;
      --ea-badge: #d29922;
      --demo-badge: #3fb950;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
      min-height: 100vh;
    }

    header {
      text-align: center;
      padding: 32px 16px 24px;
      border-bottom: 1px solid var(--border);
    }

    header h1 {
      font-size: 24px;
      font-weight: 600;
    }

    header p {
      color: var(--text-muted);
      font-size: 14px;
      margin-top: 4px;
    }

    header a {
      color: var(--accent);
      text-decoration: none;
    }

    header a:hover { text-decoration: underline; }

    main {
      max-width: 1200px;
      margin: 0 auto;
      padding-bottom: 48px;
    }

    .collection {
      padding: 24px 16px;
      border-bottom: 1px solid var(--border);
    }

    .collection:last-child { border-bottom: none; }

    .collection-name {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .collection-description {
      color: var(--text-muted);
      font-size: 14px;
      margin-bottom: 16px;
      max-width: 720px;
    }

    .collection-games {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .game-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
      transition: border-color 0.15s ease;
    }

    .game-card:hover { border-color: var(--accent); }

    .game-card a {
      text-decoration: none;
      color: inherit;
      display: block;
    }

    .game-card img {
      width: 100%;
      aspect-ratio: 292 / 136;
      object-fit: cover;
      display: block;
      background: var(--pill-bg);
    }

    .game-info { padding: 10px; }

    .game-name {
      font-size: 13px;
      font-weight: 600;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .game-date {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 2px;
    }

    .game-badges {
      display: flex;
      gap: 6px;
      margin-top: 6px;
    }

    .badge {
      font-size: 10px;
      padding: 1px 7px;
      border-radius: 10px;
      font-weight: 600;
    }

    .badge-ea { background: var(--ea-badge); color: #000; }
    .badge-demo { background: var(--demo-badge); color: #000; }

    .empty-state {
      text-align: center;
      color: var(--text-muted);
      padding: 48px 16px;
      font-size: 15px;
    }

    footer {
      text-align: center;
      padding: 24px 16px;
      color: var(--text-muted);
      font-size: 13px;
      border-top: 1px solid var(--border);
    }

    footer a {
      color: var(--accent);
      text-decoration: none;
    }

    footer a:hover { text-decoration: underline; }

    .footer-links {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 6px 16px;
      margin-top: 6px;
    }

    @media (min-width: 640px) {
      .collection-games { grid-template-columns: repeat(3, 1fr); }
      .game-name { font-size: 14px; }
    }

    @media (min-width: 1024px) {
      .collection-games { grid-template-columns: repeat(4, 1fr); gap: 16px; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Collections</h1>
    <p><a href="index.html">Back to all games</a></p>
  </header>

  <main id="collections-list"></main>

  <footer>
    <p>Created by Alon Abadi to support local game creators and the local indie scene.</p>
    <div class="footer-links">
      <a href="https://www.patreon.com/c/indiegamescoil" target="_blank" rel="noopener">Support us on Patreon</a>
      <a href="https://whatsapp.com/channel/0029Vb7JvYf17Emr2qDLEX41" target="_blank" rel="noopener">Join our WhatsApp Channel</a>
      <a href="https://www.youtube.com/@ototo3" target="_blank" rel="noopener">Subscribe on YouTube</a>
      <a href="https://indiegames.co.il/" target="_blank" rel="noopener">Read the Israeli Indie Games Newsletter</a>
    </div>
    <p style="margin-top: 16px">Data from <a href="https://store.steampowered.com/curator/2728897" target="_blank" rel="noopener">Ping 972 Steam Curator</a></p>
  </footer>

  <script src="data/data.js"></script>
  <script src="data/context-data.js"></script>
  <script>
    (function () {
      var DATA = window.ISRAELI_GAMES_DATA;
      var CONTEXT = window.GAME_CONTEXT_DATA;
      var list = document.getElementById("collections-list");

      if (!DATA || !CONTEXT || !CONTEXT.groups || CONTEXT.groups.length === 0) {
        list.innerHTML = '<p class="empty-state">No collections available.</p>';
        return;
      }

      // Build SteamID -> game lookup from all years
      var gameMap = {};
      var years = Object.keys(DATA.byYear);
      for (var i = 0; i < years.length; i++) {
        var games = DATA.byYear[years[i]];
        for (var j = 0; j < games.length; j++) {
          gameMap[String(games[j].SteamID)] = games[j];
        }
      }

      for (var g = 0; g < CONTEXT.groups.length; g++) {
        var group = CONTEXT.groups[g];

        var section = document.createElement("section");
        section.className = "collection";
        section.id = group.slug;

        var heading = document.createElement("h2");
        heading.className = "collection-name";
        var nameLink = document.createElement("a");
        nameLink.href = "#" + group.slug;
        nameLink.textContent = group.name;
        nameLink.style.color = "var(--accent)";
        nameLink.style.textDecoration = "none";
        heading.appendChild(nameLink);
        section.appendChild(heading);

        if (group.url) {
          var urlLink = document.createElement("a");
          urlLink.href = group.url;
          urlLink.target = "_blank";
          urlLink.rel = "noopener";
          urlLink.textContent = group.url;
          urlLink.style.fontSize = "0.9em";
          section.appendChild(urlLink);
        }

        if (group.description) {
          var desc = document.createElement("p");
          desc.className = "collection-description";
          desc.textContent = group.description;
          section.appendChild(desc);
        }

        var grid = document.createElement("div");
        grid.className = "collection-games";

        for (var k = 0; k < group.games.length; k++) {
          var game = gameMap[group.games[k]];
          if (!game) continue;
          grid.appendChild(createCard(game));
        }

        section.appendChild(grid);
        list.appendChild(section);
      }

      function createCard(game) {
        var card = document.createElement("div");
        card.className = "game-card";

        var link = document.createElement("a");
        link.href = game.link;
        link.target = "_blank";
        link.rel = "noopener";

        var img = document.createElement("img");
        img.src = game.image;
        img.alt = game.name;
        img.loading = "lazy";
        img.width = 292;
        img.height = 136;
        link.appendChild(img);

        var info = document.createElement("div");
        info.className = "game-info";

        var name = document.createElement("div");
        name.className = "game-name";
        name.textContent = game.name;
        name.title = game.name;
        info.appendChild(name);

        var date = document.createElement("div");
        date.className = "game-date";
        date.textContent = game.release_date;
        info.appendChild(date);

        if (game.ea || game.demo) {
          var badges = document.createElement("div");
          badges.className = "game-badges";
          if (game.ea) {
            var b = document.createElement("span");
            b.className = "badge badge-ea";
            b.textContent = "Early Access";
            badges.appendChild(b);
          }
          if (game.demo) {
            var b = document.createElement("span");
            b.className = "badge badge-demo";
            b.textContent = "Demo";
            badges.appendChild(b);
          }
          info.appendChild(badges);
        }

        link.appendChild(info);
        card.appendChild(link);
        return card;
      }
    })();
  </script>
</body>
</html>
